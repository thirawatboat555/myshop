<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</title>

<style>
body{
    font-family: Arial;
    background:#f4f4f4;
    margin:0;
}

/* HEADER */
.header{
    background:#2e7d32;
    color:white;
    padding:15px;
    text-align:center;
    font-size:20px;
}

/* BOX */
.container{
    max-width:500px;
    margin:20px auto;
    background:white;
    padding:20px;
    border-radius:12px;
    box-shadow:0 4px 10px rgba(0,0,0,.2);
}

.item{
    border-bottom:1px dashed #ccc;
    padding:8px 0;
}

.total{
    font-weight:bold;
    font-size:18px;
    text-align:right;
    margin-top:10px;
}

/* QR */
.qr{
    text-align:center;
    margin-top:20px;
}

button{
    width:100%;
    padding:12px;
    background:#ff9800;
    border:none;
    border-radius:8px;
    color:white;
    font-size:16px;
    cursor:pointer;
    margin-top:15px;
}
button:hover{
    background:#e68900;
}
</style>
</head>

<body>

<div class="header">
üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
</div>

<div class="container">

<div id="orderList"></div>

<div class="total" id="totalPrice"></div>

<div class="qr">
    <p>üì± ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
    <img src="images/qr.png" width="200">
</div>

<button onclick="paid()">‚úÖ ‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏•‡πâ‡∏ß</button>

</div>

<script>

let cartData = JSON.parse(localStorage.getItem("cart")) || {};
let order = Object.values(cartData);

let html = "";
let total = 0;

if(order.length === 0){
    html = "<p style='text-align:center;color:red'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>";
}else{

    order.forEach(item => {

        let price = Number(item.price) || 0;
        let qty = Number(item.qty) || 0;
        let sum = price * qty;

        total += sum;

        html += `
        <div class="item">
            <b>${item.name}</b><br>
            ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ${item.type || "-"}<br>
            ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏≤‡∏ô: ${item.sweet || "-"}<br>
            ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${qty}
            <span style="float:right">${sum} ‡∏ö‡∏≤‡∏ó</span>
        </div>
        `;
    });
}

document.getElementById("orderList").innerHTML = html;
document.getElementById("totalPrice").innerHTML =
"‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î : " + total + " ‡∏ö‡∏≤‡∏ó";


/* ‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô (‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤) */
function paid(){

    let orders = JSON.parse(localStorage.getItem("orders")) || [];

    // ‡πÄ‡∏û‡∏¥‡πà‡∏° sum ‡πÄ‡∏Ç‡πâ‡∏≤ item ‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß
    let itemsWithPrice = order.map(item => {

    let price = Number(item.price) || 0;
    let qty   = Number(item.qty) || 0;

    return {
        name: item.name || "-",
        type: item.type || "-",
        sweet: item.sweet || "-",
        qty: qty,
        price: price,
        sum: price * qty
    };
});


    let newOrder = {
        time: new Date().toLocaleString("th-TH"),
        total: total,
        items: itemsWithPrice
    };

    orders.push(newOrder);

    localStorage.setItem("orders", JSON.stringify(orders));

    localStorage.removeItem("cart");

    alert("‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‚úÖ");

    window.location.href="index.html";
}

</script>



</body>
</html>
